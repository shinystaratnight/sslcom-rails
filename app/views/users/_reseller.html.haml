-content_for :title, "#{Settings.community_name} Reseller Dashboard"
-r = ssl_account.reseller
=render(:partial => 'shared/form_progress_indicator', :locals => {options:{li_style: "margin: 0px 40px"}, :pages=>[Reseller::SIGNUP_PAGES_FREE, 3]}) if flash[:notice]==Reseller::WELCOME
.reseller_registration_select_tier
  %h2 SSL Reseller Dashboard
  %p
    The SSL Reseller Program is designed to ease management of bulk ssl
    certificate purchases while increasing your bottom line through volume
    discounting. With the SSL Reseller Program, you can view real-time
    processing status information of each certificate, run historical reports
    on your certificate purchases, and do a host of other administrative
    functions. And that's just the beginning....
  -if Settings.enable_affiliate_program==true && !current_user.is_affiliate?
    .become_reseller_title(style="margin: 10px 0 0")
      %p
        %strong.red NEW! Earn commissions through the #{Settings.community_name} Referral Link Program
      %p
        %a(href="https://#{Settings.community_domain}/affiliate/index.php")
          Click here
        to become an #{Settings.community_name} Referral Link Partner or
        =link_to "click here for more details", details_affiliates_path
#dashboard
  %table(cellspacing="0")
    %caption
      ssl account information for #{user.login} #{"(last logged in #{user.last_login_at.strftime("%b %d, %Y")})" unless user.last_login_at.blank?}
    %tr.heading_row
      %tr.expanded
        %td(colspan="5")
          .certificate_details
            %table(cellspacing="0")
              %tbody
                %tr.alt
                  %th account type
                  %th partner level
                  %th signup date
                  %th validation level
                %tr.alt
                  %td reseller partner
                  %td=r.reseller_tier.label
                  %td=r.created_at.strftime("%b %d, %Y") unless r.created_at.blank?
                  %td class 2
            %table(cellspacing="0")
              %tbody
                %tr
                  %td(colspan="5")
                    .certificate_details_box
                      %ul
                        %li
                          %strong reseller administrator
                        %li name: #{[r.first_name, r.last_name].join(' ')}
                        %li email: #{r.email}
                        %li phone: #{r.phone}
                        -unless r.ext.blank?
                          %li ext: #{r.ext}
                        -unless r.fax.blank?
                          %li fax: #{r.fax}
                        %li=link_to 'edit', edit_ssl_account_path(@ssl_slug || params[:ssl_slug])
                    .certificate_details_box
                      %ul
                        %li
                          %strong reseller profile
                        %li
                          \#{r.organization}
                        %li
                          \#{r.address1}
                        %li
                          \#{r.address2}
                        %li
                          \#{r.address3}
                        %li
                          \#{r.po_box}
                        %li
                          \#{[r.city, r.state, r.postal_code].join(', ')}
                        %li
                          \#{r.country}
                        %li
                          \#{r.website}
                        %li=link_to 'edit', edit_ssl_account_path(@ssl_slug || params[:ssl_slug])
                    .certificate_details_box
                      %ul
                        -if permitted_to?(:edit, :billing_profiles)
                          %li
                            %strong billing and purchase
                          -if permitted_to? :create, :funded_accounts
                            %li available funds: #{ssl_account.funded_account.amount(true).format :with_currency=>false}
                          -if permitted_to? :read, :orders
                            %li=link_to "billing", is_sandbox? ? search_orders_path(search:'is_test:true') : orders_path(ssl_slug: @ssl_slug)
                          %li=link_to 'deposit funds', allocate_funds_url(ssl_slug: @ssl_slug)
                          -if ssl_account && permitted_to?(:index, :billing_profiles)
                            %li=link_to 'manage billing profiles', billing_profiles_path(ssl_slug: @ssl_slug)
                          %li=link_to 'buy certificate', certificates_url
                          %li=link_to 'certificate pricing', reseller_tier_url(ssl_account.reseller.reseller_tier.id)
                          -if ssl_account && permitted_to?(:index, :invoices) && ssl_account.invoices.any?
                            %li=link_to 'monthly and daily invoices', invoices_path(@ssl_slug)
                %tr
                  %td(colspan="5")
                    -if ac = ssl_account.api_credential
                      .certificate_details_box
                        %ul
                          -unless user.is_validations? || user.is_billing?
                            %li
                              %strong
                                =link_to "api credentials", api_credentials_path(ssl_slug: @ssl_slug)
                          %li=link_to "developer tools", is_sandbox? ? developers_certificate_orders_url : "https://sandbox.ssl.com"
                          %li=link_to 'view documentation', "http://docs.sslcomapi.apiary.io/", target: "_new"
                    .certificate_details_box
                      %ul
                        %li
                          %strong
                            login account
                        %li username: #{user.login}
                        %li email: #{user.email}
                        %li account number: #{ssl_account.acct_number}
                        %li roles: #{user.role_symbols.join('/')}
                        =render partial: 'ssl_slug_company', locals: {user: user}
                        -if permitted_to? :admin_manage, user
                          %li=remote_login_link(user)
                        %li=link_to 'edit email address', edit_email_user_url(user)
                        %li=link_to 'change password', edit_password_user_url(user)
                        -permitted_to? :edit_settings, current_user.ssl_account do
                          %li=link_to "Settings", edit_settings_ssl_account_path(ssl_slug: @ssl_slug)
                    .certificate_details_box
                      %ul
                        -if ssl_account && permitted_to?(:read, :contacts)
                          %li
                            %strong contacts/identities
                          %li=link_to 'contacts', saved_contacts_contacts_path(ssl_slug: @ssl_slug)
                          %li=link_to 'validated identities', saved_contacts_contacts_path(ssl_slug: @ssl_slug, registrants: true)
