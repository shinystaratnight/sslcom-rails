-content_for :title, "SSL Manager Management"

= render :partial => 'index_scripts'

#search_bar.hidden
  =form_tag :search_registered_agents, :id=>'search_registered_agent_form', :method=>:post do
    =hidden_field_tag :ra_per_page, @per_page

#registered_agents
  =form_tag :remove_agents_registered_agents, :id => 'registered_agent_list', :method => :post do
    %table(cellspacing="0")
      -if @registered_agents.size > 0
        %tfoot
          %tr
            %td.wrap_number_rows
              =select_tag :ra_number_rows,
                      options_for_select([[5, 5], [10, 10], [20, 20], [50, 50], [100, 100]], @per_page),
                      :class=>'per_page'
            %td(colspan='7')=will_paginate @registered_agents
      %caption
        SSL Managers Management
        =will_paginate @registered_agents
      %tr.heading_row
        -if @registered_agents.size > 0
          %td(scope="col") IP Address
          %td(scope="col") Mac Address
          %td(scope="col") Agent
          %td(scope="col") Friendly Name
          %td(scope="col") Status
          %td(scope="col") Certificates
          %td(scope="col") Delete?
        -else
          %td(scope="col" colspan="7") Agent
      -if @registered_agents.size > 0
        -@registered_agents.each do |ra|
          %tr
            %td
              =link_to ra.ip_address, registered_agent_path(@ssl_slug, ra.id)
            %td=ra.mac_address
            %td=ra.agent
            %td=ra.friendly_name
            %td=ra.workflow_status == 'pending_registration' ? 'Pending' : 'Active'
            %td
              -if ra.managed_certificates.size > 0
                =link_to ra.managed_certificates.size, managed_certificates_registered_agent_path(@ssl_slug, ra.id)
              -else
                ='0'
            %td
              =check_box_tag "remove_agents[]", ra.id, false, class: 'chk-remove', 'data-agent-name' => ra.friendly_name
      -else
        %tr
          %td(colspan="7")
            There are no registered SSL Managers.
    -if @registered_agents.size > 0
      =submit_tag 'Save', :id => 'btn_remove_agents', :disabled => true

